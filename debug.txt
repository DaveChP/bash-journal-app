#!/bin/bash

#### date manipulations #####
min=$(date +%M);
hr=$(date +%H);
day=$(date +%d);
month=$(date +%m);
year=$(date +%Y);
dayName=$(date +%A);
monthName=$(date +%B);
dayHalf=$(date +%p);
shortDay=$(date +%-d);
shortMonth=$(date +%-m);
shortHour=$(date +%l);
suffix=th;

# generate date number suffix for readable entry;
if [ $day == 1 ] || [ $day == 21 ] || [ $day == 31 ]; then suffix=st; fi;
if [ $day == 2 ] || [ $day == 22 ]; then suffix=nd; fi;
if [ $day == 3 ] || [ $day == 23 ]; then suffix=rd; fi;


#### path and filename ####
filePath=~/journal;
if [ ! -d $filePath ]; then mkdir $filePath;fi;

filename=journal$year$month$day$hr${min}.txt;
contentString=$dayName", "$shortDay$suffix" "$monthName" "$year" at "$shortHour:$min$dayHalf;

if test -f $lastfile;
then {
monthFile=$( cat ~/journal/lastFile | awk -F"," '{print $2;}' );
lastEntry=$( cat ~/journal/lastFile | awk -F"," '{print $3;}' );

#note clever method to prepend new file onto existing one;
#printf preferable to echo to enable reliable newline insertions;
if test -f $monthFile;
  then echo $monthFile found;
  printf "$(cat $lastEntry)\n\n$(cat $monthFile)" > $monthFile;
  printf "$lastEntry'|' last modified |$( date -r $lastEntry)| when added to |$monthFile\n" >> logFile.txt;
  else touch $monthFile;
  printf "$(cat$lastEntry)\n\n$(cat$monthFile)" > $monthFile;
  printf "$lastEntry'|' last modified |$( date -r $lastEntry)| when added to |$monthFile\n" >> logFile.txt;
fi;
}
fi;


touch ~/journal/$filename;
echo $contentString >> ~/journal/$filename;
# append in case dupicate of file added in current minute; 
echo " " >> ~/journal/$filename;

### log current file to concatenate to month file next time ###
###store current filename in hidden file to concatenate onto month file next time;
echo ~/journal/$filename","$monthName"-"$year".txt,"$filename > ~/journal/lastFile;


open -a TextEdit ~/journal/$filename;

# variablename=$(echo '111 222 33' | awk '{print $3;}' )
# $((12%10))
# if [ 1 -eq 1 ]; then echo 3; fi
# if [ 1 == 1 ] || [ 1 == 2]; then echo yo; fi



# d=folderA/;
# f=file.txt;
# mkdir $d;
# touch $d$f;
#